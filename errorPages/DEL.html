<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="robots" content="nofollow,noarchive,noindex">
  <title>200 - Deleted</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/common.css">
</head>
<body>
<main>
  <article>
    <div id="message_text">
      <h1 class="source">Resource - <span data-l10n>Deleted</span></h1>
      <h1 class="target"></h1>
    </div>
  </article>
</main>

<script>
  'use strict';

  /**
   * @param {HTMLElement} $el
   */
  const Shuffle = function ($el) {
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890-=+<>,./?[{()}]!@#$%^&*~`\|'.split('');
    const $source = $el.querySelector('.source');
    const $target = $el.querySelector('.target');

    let cursor = 0;
    /** @type {Number|undefined} */
    let scrambleInterval;
    /** @type {Number|undefined} */
    let cursorDelayInterval;
    /** @type {Number|undefined} */
    let cursorInterval;

    /**
     * @param {Number} len
     * @return {string}
     */
    const getRandomizedString = function (len) {
      let s = '';

      for (let i = 0; i < len; i++) {
        s += chars[Math.floor(Math.random() * chars.length)];
      }

      return s;
    };

    this.start = function () {
      $source.style.display = 'none';
      $target.style.display = 'block';

      scrambleInterval = window.setInterval(() => {
        if (cursor <= $source.innerText.length) {
          $target.innerText = $source.innerText.substring(0, cursor) + getRandomizedString($source.innerText.length - cursor);
        }
      }, 450 / 30);

      cursorDelayInterval = window.setTimeout(() => {
        cursorInterval = window.setInterval(() => {
          if (cursor > $source.innerText.length - 1) {
            this.stop();
          }

          cursor++;
        }, 70);
      }, 350);
    };

    this.stop = function () {
      $source.style.display = 'block';
      $target.style.display = 'none';
      $target.innerText = '';
      cursor = 0;

      if (scrambleInterval !== undefined) {
        window.clearInterval(scrambleInterval);
        scrambleInterval = undefined;
      }

      if (cursorInterval !== undefined) {
        window.clearInterval(cursorInterval);
        cursorInterval = undefined;
      }

      if (cursorDelayInterval !== undefined) {
        window.clearInterval(cursorDelayInterval);
        cursorDelayInterval = undefined;
      }
    };
  };

  (new Shuffle(document.getElementById('message_text'))).start();

  window.setTimeout(function () {
    document.getElementById('details').classList.remove('hidden');
  }, 550);
</script>

</body>
</html>